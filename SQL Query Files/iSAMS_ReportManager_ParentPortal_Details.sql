SELECT TblParentPortalMenu.txtName, TblParentPortalMenu.txtHref, TblParentPortalMenu.txtHelp, TblParentPortalMenu.TblParentPortalMenuID, TblParentPortalMenu.intExecute, TblParentPortalMenu.intpopUpWidth, TblParentPortalMenu.intpopUpHeight, TblParentPortalMenu.blnResize FROM TblParentPortalMenu WHERE TblParentPortalMenu.blnActive = 1 AND TblParentPortalMenu.intParent = 16 AND ((TblParentPortalMenu.blnUser = 1) OR (TblParentPortalMenu.blnValidUser = 1))    and (txtHref <> 'api/interactive/leaverequest/')    AND (NOT txtHref = 'api/profile/markbooks/') AND (   TblParentPortalMenu.txtName <> 'Invoices' OR   (SELECT COUNT(*)     FROM TblParentPortalUserLinks [Link]     INNER JOIN TblPupilManagementFamily [Family] ON [Family].TblPupilManagementFamilyID = [Link].txtId     LEFT JOIN TblPupilManagementAddresses [FamilyAddress] ON     (       [FamilyAddress].TblPupilManagementAddressesID = [Family].intFatherID OR       [FamilyAddress].TblPupilManagementAddressesID = [Family].intMotherID     )     WHERE [Link].txtUserCode = 'ciwezapgmailcom221721215274368' AND        [FamilyAddress].bEnableSendInvoicesToParentPortal = 1) > 0 ) ORDER BY TblParentPortalMenu.intOrder;
